CREATE TABLE `user_query` (
  `time` bigint(20) unsigned NOT NULL,
  `user` varchar(64) NOT NULL,
  `client` varchar(64) DEFAULT NULL,
  `ip` varchar(64) NOT NULL,
  `helo` varchar(128) DEFAULT NULL,
  `hostname` varchar(128) DEFAULT NULL,
  `sender` varchar(256) CHARACTER SET utf8 DEFAULT NULL,
  `qualifier` enum('PASS','FAIL','SOFTFAIL','NEUTRAL') DEFAULT NULL,
  `recipient` varchar(128) CHARACTER SET utf8 NOT NULL,
  `tokenSet` text NOT NULL,
  `signerSet` text,
  `whiteKey` varchar(128) NOT NULL,
  `blockKey` varchar(128) NOT NULL,
  `result` enum('WHITE','ACCEPT','GREYLIST','LISTED','HOLD','INEXISTENT','FLAG','TRAP','REJECT','FAIL','NXDOMAIN','INVALID','BLOCK','BANNED') NOT NULL,
  `mailFrom` varchar(256) CHARACTER SET utf8 DEFAULT NULL,
  `replyto` varchar(256) CHARACTER SET utf8 DEFAULT NULL,
  `subject` text CHARACTER SET utf8mb4,
  `messageID` varchar(512) CHARACTER SET utf8mb4 DEFAULT NULL,
  `date` timestamp NULL DEFAULT NULL,
  `unsubscribe` text,
  `linkMap` text,
  `executableSet` text,
  `malware` varchar(128) CHARACTER SET utf8mb4 DEFAULT NULL,
  `adminAdvised` tinyint(1) unsigned NOT NULL DEFAULT '0',
  `senderAdvised` tinyint(1) unsigned NOT NULL DEFAULT '0',
  `recipientAdvised` tinyint(1) unsigned NOT NULL DEFAULT '0',
  `userAdvised` tinyint(1) unsigned NOT NULL DEFAULT '0',
  `abuseAdvised` tinyint(1) unsigned NOT NULL DEFAULT '0',
  PRIMARY KEY (`time`) USING BTREE,
  KEY `id_user_query_messageID` (`messageID`(191)) USING BTREE,
  KEY `id_user_query_user` (`user`) USING BTREE,
  KEY `id_user_query_result` (`result`) USING BTREE,
  KEY `id_user_query_adminAdvised` (`adminAdvised`) USING BTREE,
  KEY `id_user_query_senderAdvised` (`senderAdvised`) USING BTREE,
  KEY `id_user_query_recipientAdvised` (`recipientAdvised`) USING BTREE,
  KEY `id_user_query_userAdvised` (`userAdvised`) USING BTREE,
  KEY `id_user_query_abuseAdvised` (`abuseAdvised`) USING BTREE,
  KEY `id_user_query_ip` (`ip`) USING BTREE,
  KEY `id_user_query_sender` (`sender`(255)) USING BTREE,
  KEY `id_user_query_mailFrom` (`mailFrom`(255)) USING BTREE,
  KEY `id_user_query_replyto` (`replyto`(255)) USING BTREE,
  KEY `id_user_query_recipient` (`recipient`) USING BTREE,
  KEY `id_user_query_whiteKey` (`whiteKey`) USING BTREE,
  KEY `id_user_query_blockKey` (`blockKey`) USING BTREE,
  KEY `id_user_query_helo` (`helo`) USING BTREE,
  KEY `id_user_query_hostname` (`hostname`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=ascii;

CREATE TABLE `analise` (
  `token` varchar(128) NOT NULL,
  `tokenStatus` enum('PROCESSING','RESOLVED','NONE','NXDOMAIN','BLOCK','DNSBL','DYNAMIC','GENERIC','GREEN','YELLOW','RED','PROVIDER','IGNORE','WHITE','FQDN','UNAVAILABLE','TIMEOUT') NOT NULL COMMENT 'Mudar para enumeration',
  `name` varchar(128) DEFAULT NULL,
  `nameMask` varchar(128) DEFAULT NULL,
  `nameStatus` enum('NONE','NXDOMAIN','RESERVED','BLOCK','DYNAMIC','GENERIC','INVALID','GREEN','YELLOW','RED','PROVIDER','IGNORE','WHITE','UNAVAILABLE','TIMEOUT','FQDN') DEFAULT NULL,
  `reputation` float NOT NULL DEFAULT '0',
  `date` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`token`),
  KEY `id_tokenStatus` (`tokenStatus`) USING BTREE,
  KEY `id_nameStatus` (`nameStatus`),
  KEY `id_nameMask` (`nameMask`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=ascii;

